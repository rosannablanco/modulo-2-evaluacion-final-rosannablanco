"use strict";const inputElement=document.querySelector(".js-input"),btnElement=document.querySelector(".js-btn"),ulSerie=document.querySelector(".js-ul-serie"),ulFav=document.querySelector(".js-ul-fav");let resultSeries=new Array,seriesFav=new Array;const classSerie="ul__li js-li-serie",classFav="ul__li js-li-ul-fav";function getDataApi(){const e=inputElement.value;fetch("http://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{saveDataShow(e)})}function saveDataShow(e){ulSerie.innerHTML="",resultSeries=[];for(let t=0;t<e.length;t++){let s=e[t].show;resultSeries.push(s)}paintHtmlResults(resultSeries,ulSerie,classSerie)}function paintHtmlResults(e,t,s){t.innerHTML="";for(const a of e){const e=document.createElement("li");e.setAttribute("class",s),e.setAttribute("data-id",a.id);const n=document.createElement("h4");n.setAttribute("class","ul__li__title");const i=document.createTextNode(a.name),r=document.createElement("img");r.setAttribute("class","ul__li__img"),null===a.image?r.setAttribute("src","https://via.placeholder.com/210x295/ffffff/666666/?text=TV"):r.setAttribute("src",a.image.medium);const l=document.createElement("button");l.setAttribute("class","ul__li__btn btn delete");const o=document.createTextNode("Borrar fav"),c=document.createElement("button");c.setAttribute("class","ul__li__btn btn add");const u=document.createTextNode("AÃ±adir fav");c.appendChild(u),l.appendChild(o),n.appendChild(i),e.appendChild(n),e.appendChild(r),e.appendChild(c),e.appendChild(l),t.appendChild(e),s===classFav&&e.removeChild(c),c.addEventListener("click",saveSerieFav),l.addEventListener("click",removeFav)}compareLists()}function saveSerieFav(e){const t=e.currentTarget.parentElement;t.classList.add("class-fav");const s=parseInt(t.dataset.id);let a;for(const e of resultSeries)s===e.id&&(a=e);seriesFav.push(a),paintHtmlResults(seriesFav,ulFav,classFav),setInSessionStorage()}function removeFav(e){const t=e.currentTarget.parentElement;let s=parseInt(t.dataset.id);for(let e=0;e<seriesFav.length;e++)s===seriesFav[e].id&&seriesFav.splice(e,1);let a=ulSerie.children;for(let e of a){s===parseInt(e.dataset.id)&&e.classList.remove("class-fav")}paintHtmlResults(seriesFav,ulFav,classFav),setInSessionStorage()}function setInSessionStorage(){const e=JSON.stringify(seriesFav);sessionStorage.setItem("seriesFav",e)}const getFromSessionStorage=()=>{const e=sessionStorage.getItem("seriesFav");null!==e&&(seriesFav=JSON.parse(e))};function compareLists(){if(null!==seriesFav){let e=ulSerie.querySelectorAll(".js-li-serie");for(let t of e){const e=parseInt(t.dataset.id);for(const s of seriesFav){e===s.id&&t.classList.add("class-fav")}}}}btnElement.addEventListener("click",getDataApi),getFromSessionStorage(),paintHtmlResults(seriesFav,ulFav,classFav);